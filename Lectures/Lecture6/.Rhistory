install.packages("ggrepel")
install.packages("ggpmisc")
library(tidyverse)
library(ggrepel)
library(ggpmisc)
getwd()
wbgender <- read_csv("worldbank-genderstats.csv") #ADD ARGUMENT TO ADDRESS NAs
keepvars <- c("SE.TER.GRAD.FE.SI.ZS", "SH.MMR.LEVE", "SP.UWT.TFRT")
stem <- wbgender %>% filter(`Series Code` %in% keepvars)
View(wbgender)
wbgender <- read_csv("worldbank-genderstats.csv", na = "..") #ADD ARGUMENT TO ADDRESS NAs
keepvars <- c("SE.TER.GRAD.FE.SI.ZS", "SH.MMR.LEVE", "SP.UWT.TFRT")
stem <- wbgender %>% filter(`Series Code` %in% keepvars)
stem.fmshstemgrads <- wbgender %>% filter(`Series Code` == "SE.TER.GRAD.FE.SI.ZS")
stem.dayspaidmatleave <- wbgender %>% filter(`Series Code` == "SH.MMR.LEVE")
stem.unmetcontr <- wbgender %>% filter(`Series Code` == "SP.UWT.TFRT")
summary(stem.fmshstemgrads)
summary(stem.dayspaidmatleave)
summary(stem.unmetcontr)
stem.fmshstemgrads_long <- stem.fmshstemgrads %>%
pivot_longer(cols = `2011 [YR2011]`:`2020 [YR2020]`,
names_to = "Years",   #ARGUMENT FOR TIME VARIABLE IN THIS EX
values_to = "value" )
View(stem.fmshstemgrads_long)
View(stem.fmshstemgrads)
stem.fmshstemgrads_cross <- stem.fmshstemgrads %>%
pivot_longer(cols = `2011 [YR2011]`:`2020 [YR2020]`,
names_to = "Years",
values_to = "value") %>%
group_by(`Country Name`,`Country Code`) %>%
summarise(fmshstemgrads = round(mean(value, na.rm = TRUE),2) )
View(stem.unmetcontr)
View(stem.fmshstemgrads_long)
View(stem.unmetcontr)
View(stem.fmshstemgrads_cross)
View(stem)
stem.dayspaidmatleave_cross  <- stem.dayspaidmatleave  %>%
pivot_longer(cols = `2011 [YR2011]`:`2020 [YR2020]`,
names_to = "Year",
values_to = "value") %>%
group_by(`Country Name`,`Country Code`) %>%
summarise(dayspaidmatleave = round(mean(value, na.rm = TRUE), 2) )
stem.unmetcontr_cross <- stem.unmetcontr %>%
pivot_longer(cols = `2011 [YR2011]`:`2020 [YR2020]`,
names_to = "Year",
values_to = "value") %>%
group_by(`Country Name`,`Country Code`) %>%
summarise(unmetcontr = round(mean(value, na.rm = TRUE), 2) )
stem.cross <- stem.fmshstemgrads_cross %>%
inner_join(stem.unmetcontr_cross)
View(stem.cross)
stem.cross <- stem.fmshstemgrads_cross %>%
inner_join(stem.unmetcontr_cross) %>%
inner_join(stem.dayspaidmatleave_cross)
summary(stem.cross)
stem.cross <- stem.fmshstemgrads_cross %>%
inner_join(stem.unmetcontr_cross) %>%
inner_join(stem.dayspaidmatleave_cross) %>%
na.omit
summary(stem.cross)
stem.cross %>%
ggplot(aes(x = dayspaidmatleave, y = fmshstemgrads)) +
geom_point()
stem.cross %>%
ggplot(aes(x = dayspaidmatleave,
y = fmshstemgrads,
color = unmetcontr)) +
geom_point()
stem.cross %>%
ggplot(aes(x = dayspaidmatleave,
y = fmshstemgrads,
color = unmetcontr,
label = `Country Code`)) +
geom_point()
ggplot(stem.cross,
aes(x = dayspaidmatleave,
y = fmshstemgrads,
label = `Country Code`,
color = unmetcontr)) +
geom_point() +
stat_dens2d_filter(geom = "text_repel", keep.fraction = 0.2) +
scale_colour_gradient(low = "blue", high = "red") +
ylab("Female share of graduates from STEM programs") + xlab("Days of paid maternity leave") +
labs(color = "Unmet need \nfor contraception \n(% of married women \nages 15-49)") +
theme(legend.position = "right")
cor(stem.cross$dayspaidmatleave, stem.cross$fmshstemgrads)
cor(stem.cross$unmetcontr, stem.cross$fmshstemgrads)
cor(stem.cross$dayspaidmatleave, stem.cross$unmetcontr)
